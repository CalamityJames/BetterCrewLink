{"version":3,"file":"Overlay.js","sourceRoot":"","sources":["Overlay.tsx"],"names":[],"mappings":"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","sourcesContent":["import React, { useEffect, useMemo, useState, CSSProperties } from 'react';\r\nimport { ipcRenderer } from 'electron';\r\nimport { AmongUsState, GameState, VoiceState } from '../common/AmongUsState';\r\nimport { IpcOverlayMessages, IpcMessages } from '../common/ipc-messages';\r\nimport ReactDOM from 'react-dom';\r\nimport makeStyles from '@material-ui/core/styles/makeStyles';\r\nimport './css/overlay.css';\r\nimport Avatar from './Avatar';\r\nimport { ISettings } from '../common/ISettings';\r\nimport { DEFAULT_PLAYERCOLORS } from '../main/avatarGenerator';\r\n\r\ninterface UseStylesProps {\r\n\theight: number;\r\n\twidth: number;\r\n\toldHud: boolean;\r\n}\r\n\r\nexport interface playerContainerCss extends CSSProperties {\r\n\t'--size': string;\r\n}\r\n\r\nconst useStyles = makeStyles(() => ({\r\n\tmeetingHud: {\r\n\t\tposition: 'absolute',\r\n\t\ttop: '50%',\r\n\t\tleft: '50%',\r\n\t\twidth: ({ width }: UseStylesProps) => width,\r\n\t\theight: ({ height }: UseStylesProps) => height,\r\n\t\ttransform: 'translate(-50%, -50%)',\r\n\t},\r\n\ttabletContainer: {\r\n\t\twidth: ({ oldHud }: UseStylesProps) => (oldHud ? '88.45%' : '100%'),\r\n\t\theight: '10.5%',\r\n\t\tleft: ({ oldHud }: UseStylesProps) => (oldHud ? '4.7%' : '0.4%'),\r\n\t\ttop: ({ oldHud }: UseStylesProps) => (oldHud ? '18.4703%' : '15%'),\r\n\t\tposition: 'absolute',\r\n\t\tdisplay: 'flex',\r\n\t\tflexWrap: 'wrap',\r\n\t},\r\n\tplayerContainer: {\r\n\t\twidth: ({ oldHud }: UseStylesProps) => (oldHud ? '46.41%' : '30%'),\r\n\t\theight: ({ oldHud }: UseStylesProps) => (oldHud ? '100%' : '109%'),\r\n\t\tborderRadius: ({ height }: UseStylesProps) => height / 100,\r\n\t\ttransition: 'opacity .1s linear',\r\n\t\tmarginBottom: ({ oldHud }: UseStylesProps) => (oldHud ? '2%' : '1.9%'),\r\n\t\tmarginRight: ({ oldHud }: UseStylesProps) => (oldHud ? '2.34%' : '0.23%'),\r\n\t\tmarginLeft: ({ oldHud }: UseStylesProps) => (oldHud ? '0%' : '2.4%'),\r\n\t\tboxSizing: 'border-box',\r\n\t},\r\n}));\r\n\r\nfunction useWindowSize() {\r\n\tconst [windowSize, setWindowSize] = useState<[number, number]>([0, 0]);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst onResize = () => {\r\n\t\t\tsetWindowSize([window.innerWidth, window.innerHeight]);\r\n\t\t};\r\n\t\twindow.addEventListener('resize', onResize);\r\n\t\tonResize();\r\n\r\n\t\treturn () => window.removeEventListener('resize', onResize);\r\n\t}, []);\r\n\treturn windowSize;\r\n}\r\n\r\nconst iPadRatio = 854 / 579;\r\n\r\nconst Overlay: React.FC = function () {\r\n\tconst [gameState, setGameState] = useState<AmongUsState>((undefined as unknown) as AmongUsState);\r\n\tconst [voiceState, setVoiceState] = useState<VoiceState>((undefined as unknown) as VoiceState);\r\n\tconst [settings, setSettings] = useState<ISettings>((undefined as unknown) as ISettings);\r\n\tconst [playerColors, setColors] = useState<string[][]>(DEFAULT_PLAYERCOLORS);\r\n\tuseEffect(() => {\r\n\t\tconst onState = (_: Electron.IpcRendererEvent, newState: AmongUsState) => {\r\n\t\t\tsetGameState(newState);\r\n\t\t};\r\n\t\tconst onVoiceState = (_: Electron.IpcRendererEvent, newState: VoiceState) => {\r\n\t\t\tsetVoiceState(newState);\r\n\t\t};\r\n\t\tconst onSettings = (_: Electron.IpcRendererEvent, newState: ISettings) => {\r\n\t\t\tconsole.log('Recieved settings..');\r\n\r\n\t\t\tsetSettings(newState);\r\n\t\t};\r\n\t\tconst onColorChange = (_: Electron.IpcRendererEvent, colors: string[][]) => {\r\n\t\t\tconsole.log('Recieved colors..');\r\n\t\t\tsetColors(colors);\r\n\t\t\tconsole.log('new colors: ', playerColors);\r\n\t\t};\r\n\t\tipcRenderer.on(IpcOverlayMessages.NOTIFY_GAME_STATE_CHANGED, onState);\r\n\t\tipcRenderer.on(IpcOverlayMessages.NOTIFY_VOICE_STATE_CHANGED, onVoiceState);\r\n\t\tipcRenderer.on(IpcOverlayMessages.NOTIFY_SETTINGS_CHANGED, onSettings);\r\n\t\tipcRenderer.on(IpcOverlayMessages.NOTIFY_PLAYERCOLORS_CHANGED, onColorChange);\r\n\t\tipcRenderer.send(IpcMessages.SEND_TO_MAINWINDOW, IpcOverlayMessages.REQUEST_INITVALUES);\r\n\t\tconsole.log('REQUEST_INITVALUES');\r\n\t\treturn () => {\r\n\t\t\tipcRenderer.off(IpcOverlayMessages.NOTIFY_GAME_STATE_CHANGED, onState);\r\n\t\t\tipcRenderer.off(IpcOverlayMessages.NOTIFY_VOICE_STATE_CHANGED, onVoiceState);\r\n\t\t\tipcRenderer.off(IpcOverlayMessages.NOTIFY_SETTINGS_CHANGED, onSettings);\r\n\t\t\tipcRenderer.on(IpcOverlayMessages.NOTIFY_PLAYERCOLORS_CHANGED, onColorChange);\r\n\t\t};\r\n\t}, []);\r\n\r\n\tif (!settings || !voiceState || !gameState || !settings.enableOverlay || gameState.gameState == GameState.MENU)\r\n\t\treturn null;\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{settings.meetingOverlay && gameState.gameState === GameState.DISCUSSION && (\r\n\t\t\t\t<MeetingHud gameState={gameState} voiceState={voiceState} playerColors={playerColors} />\r\n\t\t\t)}\r\n\t\t\t{settings.overlayPosition !== 'hidden' && (\r\n\t\t\t\t<AvatarOverlay\r\n\t\t\t\t\tvoiceState={voiceState}\r\n\t\t\t\t\tgameState={gameState}\r\n\t\t\t\t\tposition={settings.overlayPosition}\r\n\t\t\t\t\tcompactOverlay={settings.compactOverlay}\r\n\t\t\t\t/>\r\n\t\t\t)}\r\n\t\t</>\r\n\t);\r\n};\r\n\r\ninterface AvatarOverlayProps {\r\n\tvoiceState: VoiceState;\r\n\tgameState: AmongUsState;\r\n\tposition: ISettings['overlayPosition'];\r\n\tcompactOverlay: boolean;\r\n}\r\n\r\nconst AvatarOverlay: React.FC<AvatarOverlayProps> = ({\r\n\tvoiceState,\r\n\tgameState,\r\n\tposition,\r\n\tcompactOverlay,\r\n}: AvatarOverlayProps) => {\r\n\tif (!gameState.players) return null;\r\n\r\n\tconst positionParse = position.replace('1', '');\r\n\r\n\tconst avatars: JSX.Element[] = [];\r\n\tconst isOnSide = positionParse == 'right' || positionParse == 'left';\r\n\tconst showName = isOnSide && (!compactOverlay || position === 'right1' || position === 'left1');\r\n\tconst classnames: string[] = ['overlay-wrapper'];\r\n\tif (gameState.gameState == GameState.UNKNOWN || gameState.gameState == GameState.MENU) {\r\n\t\tclassnames.push('gamestate_menu');\r\n\t} else {\r\n\t\tclassnames.push('gamestate_game');\r\n\t\tclassnames.push('overlay_postion_' + positionParse);\r\n\t\tif (compactOverlay || position === 'right1' || position === 'left1') {\r\n\t\t\tclassnames.push('compactoverlay');\r\n\t\t}\r\n\t\tif (position === 'left1' || position === 'right1') {\r\n\t\t\tclassnames.push('overlay_postion_' + position);\r\n\t\t}\r\n\t}\r\n\r\n\tconst players = useMemo(() => {\r\n\t\tif (!gameState.players) return null;\r\n\t\tconst playerss = gameState.players\r\n\t\t\t.filter((o) => !voiceState.localIsAlive || !(voiceState.otherDead[o.clientId] && !o.isLocal))\r\n\t\t\t.slice()\r\n\t\t\t.sort((a, b) => {\r\n\t\t\t\tif (\r\n\t\t\t\t\t(a.disconnected || voiceState.otherDead[a.clientId]) &&\r\n\t\t\t\t\t(b.disconnected || voiceState.otherDead[b.clientId])\r\n\t\t\t\t) {\r\n\t\t\t\t\treturn a.id - b.id;\r\n\t\t\t\t} else if (a.disconnected || voiceState.otherDead[a.clientId]) {\r\n\t\t\t\t\treturn 1000;\r\n\t\t\t\t} else if (b.disconnected || voiceState.otherDead[b.clientId]) {\r\n\t\t\t\t\treturn -1000;\r\n\t\t\t\t}\r\n\t\t\t\treturn a.id - b.id;\r\n\t\t\t});\r\n\r\n\t\treturn playerss;\r\n\t}, [gameState.players]);\r\n\r\n\t// const myPLayer = useMemo(() => {\r\n\t// \tif (!gameState.players) return null;\r\n\t// \treturn gameState.players.find(o => o.isLocal && (!o.disconnected || !o.bugged))\r\n\t// }, [gameState.players]);\r\n\r\n\tplayers?.forEach((player) => {\r\n\t\tif (!voiceState.otherTalking[player.clientId] && !(player.isLocal && voiceState.localTalking) && compactOverlay) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst peer = voiceState.playerSocketIds[player.clientId];\r\n\t\tconst connected = voiceState.socketClients[peer]?.clientId === player.clientId;\r\n\t\tif (!connected && !player.isLocal) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst talking =\r\n\t\t\t!player.inVent && (voiceState.otherTalking[player.clientId] || (player.isLocal && voiceState.localTalking));\r\n\t\t// const audio = voiceState.audioConnected[peer];\r\n\t\tavatars.push(\r\n\t\t\t<div key={player.id} className=\"player_wrapper\">\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<Avatar\r\n\t\t\t\t\t\tkey={player.id}\r\n\t\t\t\t\t\t// connectionState={!connected ? 'disconnected' : audio ? 'connected' : 'novoice'}\r\n\t\t\t\t\t\tplayer={player}\r\n\t\t\t\t\t\tshowborder={isOnSide && !compactOverlay}\r\n\t\t\t\t\t\tmuted={voiceState.muted && player.isLocal}\r\n\t\t\t\t\t\tdeafened={voiceState.deafened && player.isLocal}\r\n\t\t\t\t\t\tconnectionState={'connected'}\r\n\t\t\t\t\t\ttalking={talking}\r\n\t\t\t\t\t\tborderColor={!player.isLocal || player.shiftedColor == -1 ? '#2ecc71' : 'gray'}\r\n\t\t\t\t\t\tisUsingRadio={voiceState.impostorRadioClientId == player.clientId}\r\n\t\t\t\t\t\tisAlive={!voiceState.otherDead[player.clientId] || (player.isLocal && !player.isDead)}\r\n\t\t\t\t\t\tsize={100}\r\n\t\t\t\t\t\tlookLeft={!(positionParse === 'left' || positionParse === 'bottom_left')}\r\n\t\t\t\t\t\toverflow={isOnSide && !showName}\r\n\t\t\t\t\t\tshowHat={true}\r\n\t\t\t\t\t\tmod={voiceState.mod}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t\t{showName && (\r\n\t\t\t\t\t<span\r\n\t\t\t\t\t\tclassName=\"playername\"\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\topacity: (position === 'right1' || position === 'left1') && !talking ? 0 : 1,\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<small>{player.name}</small>\r\n\t\t\t\t\t</span>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t);\r\n\t});\r\n\tif (avatars.length === 0) return null;\r\n\tconst playerContainerStyle = { '--size': 7.5 * (10 / avatars.length) + 'vh' } as playerContainerCss;\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<div className={classnames.join(' ')} style={playerContainerStyle}>\r\n\t\t\t\t<div className=\"otherplayers\">\r\n\t\t\t\t\t<div className=\"players_container playerContainerBack\">{avatars}</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t{/* {(voiceState.muted || voiceState.deafened) && (\r\n\t\t\t\t<div className=\"volumeicons\">{voiceState.deafened ? <VolumeOff /> : <MicOff />}</div>\r\n\t\t\t)} */}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\ninterface MeetingHudProps {\r\n\tgameState: AmongUsState;\r\n\tvoiceState: VoiceState;\r\n\tplayerColors: string[][];\r\n}\r\n\r\nconst MeetingHud: React.FC<MeetingHudProps> = ({ voiceState, gameState, playerColors }: MeetingHudProps) => {\r\n\tconst [windowWidth, windowheight] = useWindowSize();\r\n\tconst [width, height] = useMemo(() => {\r\n\t\tif (gameState.oldMeetingHud) {\r\n\t\t\tlet hudWidth = 0,\r\n\t\t\t\thudHeight = 0;\r\n\t\t\tif (windowWidth / (windowheight * 0.96) > iPadRatio) {\r\n\t\t\t\thudHeight = windowWidth * 0.96;\r\n\t\t\t\thudWidth = hudHeight * iPadRatio;\r\n\t\t\t} else {\r\n\t\t\t\thudWidth = windowWidth;\r\n\t\t\t\thudHeight = windowWidth * (1 / iPadRatio);\r\n\t\t\t}\r\n\t\t\treturn [hudWidth, hudWidth];\r\n\t\t}\r\n\r\n\t\tlet resultW;\r\n\t\tconst ratio_diff = Math.abs(windowWidth / windowheight - 1.7);\r\n\r\n\t\tif (ratio_diff < 0.25) {\r\n\t\t\tresultW = windowWidth / 1.192;\r\n\t\t} else if (ratio_diff < 0.5) {\r\n\t\t\tresultW = windowWidth / 1.146;\r\n\t\t} else {\r\n\t\t\tresultW = windowWidth / 1.591;\r\n\t\t}\r\n\r\n\t\tconst resultH = resultW / 1.72;\r\n\t\t// console.log(\"Ratio: \", windowWidth, windowheight, ratio.toFixed(1), ratio, Math.round(ratio * 10) / 10, Math.abs(ratio - 1.7))\r\n\t\treturn [resultW, resultH];\r\n\t}, [windowWidth, windowheight, gameState.oldMeetingHud]);\r\n\r\n\tconst classes = useStyles({\r\n\t\twidth: width,\r\n\t\theight: height,\r\n\t\toldHud: gameState.oldMeetingHud,\r\n\t});\r\n\tconst players = useMemo(() => {\r\n\t\tif (!gameState.players) return null;\r\n\t\treturn gameState.players.slice().sort((a, b) => {\r\n\t\t\tif ((a.disconnected || a.isDead) && (b.disconnected || b.isDead)) {\r\n\t\t\t\treturn a.id - b.id;\r\n\t\t\t} else if (a.disconnected || a.isDead) {\r\n\t\t\t\treturn 1000;\r\n\t\t\t} else if (b.disconnected || b.isDead) {\r\n\t\t\t\treturn -1000;\r\n\t\t\t}\r\n\t\t\treturn a.id - b.id;\r\n\t\t});\r\n\t}, [gameState.gameState]);\r\n\tif (!players || gameState.gameState !== GameState.DISCUSSION) return null;\r\n\r\n\tconst overlays = players.map((player) => {\r\n\t\tconst color = playerColors[player.colorId] ? playerColors[player.colorId][0] : '#C51111';\r\n\r\n\t\treturn (\r\n\t\t\t<div\r\n\t\t\t\tkey={player.id}\r\n\t\t\t\tclassName={classes.playerContainer}\r\n\t\t\t\tstyle={{\r\n\t\t\t\t\topacity: voiceState.otherTalking[player.clientId] || (player.isLocal && voiceState.localTalking) ? 1 : 0,\r\n\t\t\t\t\tborder: 'solid',\r\n\t\t\t\t\tborderWidth: '2px',\r\n\t\t\t\t\tborderColor: '#00000037',\r\n\t\t\t\t\tboxShadow: `0 0 ${height / 100}px ${height / 100}px ${color}`,\r\n\t\t\t\t\ttransition: 'opacity 400ms',\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t);\r\n\t});\r\n\r\n\treturn (\r\n\t\t<div className={classes.meetingHud}>\r\n\t\t\t<div className={classes.tabletContainer}>{overlays}</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nReactDOM.render(<Overlay />, document.getElementById('app'));\r\n\r\nexport default Overlay;\r\n"]}