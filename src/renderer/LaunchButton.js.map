{"version":3,"file":"LaunchButton.js","sourceRoot":"","sources":["LaunchButton.tsx"],"names":[],"mappings":"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","sourcesContent":["import { ipcRenderer } from 'electron';\r\nimport React, { useContext, useEffect, useRef, useState } from 'react';\r\nimport { GamePlatformInstance, GamePlatformMap } from '../common/GamePlatform';\r\nimport { SettingsContext } from './contexts';\r\nimport makeStyles from '@material-ui/core/styles/makeStyles';\r\nimport { IpcMessages } from '../common/ipc-messages';\r\nimport { Button, ClickAwayListener, MenuItem, MenuList, Paper, Popper } from '@material-ui/core';\r\nimport { ToggleButton } from '@material-ui/lab';\r\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\r\nimport { CustomPlatformSettings } from './settings/CustomPlatformSettings';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n\tbutton_group: {\r\n\t\tdisplay: 'inline-flex',\r\n\t\tmargin: '0px 10px',\r\n\t},\r\n\tbutton_primary: {\r\n\t\tcolor: 'white',\r\n\t\tbackground: 'none',\r\n\t\tpadding: '2px 10px',\r\n\t\tborderRadius: '10px 0px 0px 10px',\r\n\t\tborderWidth: '4px 2px 4px 4px',\r\n\t\tborderStyle: 'solid',\r\n\t\tborderColor: 'white',\r\n\t\tfontSize: 24,\r\n\t\toutline: 'none',\r\n\t\tfontWeight: 500,\r\n\t\tfontFamily: '\"Varela\", sans-serif',\r\n\t\t'&:hover': {\r\n\t\t\tborderColor: '#00ff00',\r\n\t\t\tcursor: 'pointer',\r\n\t\t},\r\n\t\ttextTransform: 'none',\r\n\t},\r\n\tbutton_dropdown: {\r\n\t\t'&.Mui-selected': {\r\n\t\t\tborderColor: '#00ff00',\r\n\t\t},\r\n\t\tcolor: 'white',\r\n\t\tbackground: 'none',\r\n\t\tpadding: '0px 0px',\r\n\t\tborderRadius: '0px 10px 10px 0px',\r\n\t\tborderWidth: '4px 4px 4px 2px',\r\n\t\tborderStyle: 'solid',\r\n\t\tborderColor: 'white',\r\n\t\t'&:hover': {\r\n\t\t\tborderColor: '#00ff00',\r\n\t\t\tcursor: 'pointer',\r\n\t\t},\r\n\t\tminWidth: '40px',\r\n\t},\r\n\tdropdown: {\r\n\t\tmaxHeight: 110,\r\n\t\toverflow: 'auto',\r\n\t\tborder: '1px solid rgba(255, 255, 255, 0.3)',\r\n\t\tbackground: '#272727',\r\n\t},\r\n}));\r\n\r\nexport interface LauncherProps {\r\n\tt: (key: string) => string;\r\n}\r\n\r\nconst LaunchButton: React.FC<LauncherProps> = function ({ t }: LauncherProps) {\r\n\tconst classes = useStyles();\r\n\r\n\tconst [settings, setSettings] = useContext(SettingsContext);\r\n\r\n\tconst [openMessage, setOpenMessage] = useState(<>{t('game.error_platform')}</>);\r\n\tconst [dropdownOpen, setDropdownOpen] = useState(false);\r\n\tconst [launchPlatforms, setLaunchPlatforms] = useState<GamePlatformMap>();\r\n\tconst [launchItemList, setLaunchItemList] = useState([] as JSX.Element[]);\r\n\tconst [customPlatformOpen, setCustomPlatformOpen] = useState(false);\r\n\tconst [customPlatformEdit, setCustomPlatformEdit] = useState((undefined as unknown) as GamePlatformInstance);\r\n\r\n\tconst anchorRef = useRef(null);\r\n\r\n\t// Grab available platforms from main thread\r\n\tuseEffect(() => {\r\n\t\tipcRenderer\r\n\t\t\t.invoke(IpcMessages.REQUEST_PLATFORMS_AVAILABLE, settings.customPlatforms)\r\n\t\t\t.then((result: GamePlatformMap) => {\r\n\t\t\t\tsetLaunchPlatforms(result);\r\n\t\t\t});\r\n\t}, [settings.customPlatforms]);\r\n\r\n\t// If launchPlatformSettings changes: select the first available platform and re-compute list of platforms\r\n\tuseEffect(() => {\r\n\t\tif (!launchPlatforms) return;\r\n\t\tif (!launchPlatforms[settings.launchPlatform]) {\r\n\t\t\tfor (const key in launchPlatforms) {\r\n\t\t\t\tsetSettings({\r\n\t\t\t\t\ttype: 'setOne',\r\n\t\t\t\t\taction: ['launchPlatform', key],\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Generate an array of <MenuItem>'s from available platforms for dropdown\r\n\t\tconst platformArray = Array.from(Object.keys(launchPlatforms)).reduce((filtered: JSX.Element[], key) => {\r\n\t\t\tconst platform = launchPlatforms[key];\r\n\t\t\tconst platformName = platform.default ? t(platform.translateKey) : platform.translateKey;\r\n\t\t\tfiltered.push(\r\n\t\t\t\t<MenuItem\r\n\t\t\t\t\tkey={platformName}\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tsetSettings({\r\n\t\t\t\t\t\t\ttype: 'setOne',\r\n\t\t\t\t\t\t\taction: ['launchPlatform', platform.key],\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tsetDropdownOpen(false);\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tonContextMenu={() => {\r\n\t\t\t\t\t\tif (platform.default) {\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsetCustomPlatformEdit(platform);\r\n\t\t\t\t\t\tsetDropdownOpen(false);\r\n\t\t\t\t\t\tsetCustomPlatformOpen(true);\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t{platformName}\r\n\t\t\t\t</MenuItem>\r\n\t\t\t);\r\n\t\t\treturn filtered;\r\n\t\t}, []);\r\n\r\n\t\tplatformArray.push(\r\n\t\t\t<MenuItem\r\n\t\t\t\tkey={t('platform.custom')}\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t\tsetCustomPlatformEdit((undefined as unknown) as GamePlatformInstance);\r\n\t\t\t\t\tsetDropdownOpen(false);\r\n\t\t\t\t\tsetCustomPlatformOpen(true);\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t{t('platform.custom')}\r\n\t\t\t</MenuItem>\r\n\t\t);\r\n\t\tsetLaunchItemList(platformArray);\r\n\t}, [launchPlatforms]);\r\n\r\n\t// Update button message when platform changes or no platforms are available (list empty)\r\n\tuseEffect(() => {\r\n\t\tif (!launchPlatforms) return;\r\n\t\tif (launchItemList.length > 1) {\r\n\t\t\tsetOpenMessage(<>{t(launchPlatforms[settings.launchPlatform].translateKey)}</>);\r\n\t\t} else {\r\n\t\t\tsetOpenMessage(<>{t('game.error_platform')}</>);\r\n\t\t}\r\n\t}, [launchItemList, settings.launchPlatform]);\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<CustomPlatformSettings\r\n\t\t\t\tt={t}\r\n\t\t\t\topen={customPlatformOpen}\r\n\t\t\t\tsetOpenState={setCustomPlatformOpen}\r\n\t\t\t\teditPlatform={customPlatformEdit}\r\n\t\t\t/>\r\n\t\t\t<div className={classes.button_group} ref={anchorRef}>\r\n\t\t\t\t<Button\r\n\t\t\t\t\tclassName={classes.button_primary}\r\n\t\t\t\t\tdisabled={launchItemList.length === 1}\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tipcRenderer.send(IpcMessages.OPEN_AMONG_US_GAME, launchPlatforms![settings.launchPlatform]);\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t{openMessage}\r\n\t\t\t\t</Button>\r\n\t\t\t\t<ToggleButton\r\n\t\t\t\t\tclassName={classes.button_dropdown}\r\n\t\t\t\t\tonClick={() => setDropdownOpen((status) => !status)}\r\n\t\t\t\t\tselected={dropdownOpen}\r\n\t\t\t\t\tvalue=\"\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<ArrowDropDownIcon />\r\n\t\t\t\t</ToggleButton>\r\n\t\t\t</div>\r\n\t\t\t<Popper\r\n\t\t\t\topen={dropdownOpen}\r\n\t\t\t\tanchorEl={anchorRef.current}\r\n\t\t\t\tplacement=\"bottom-end\"\r\n\t\t\t\tdisablePortal={false}\r\n\t\t\t\tclassName={classes.dropdown}\r\n\t\t\t\tmodifiers={{\r\n\t\t\t\t\tflip: {\r\n\t\t\t\t\t\tenabled: false,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tpreventOverflow: {\r\n\t\t\t\t\t\tenabled: true,\r\n\t\t\t\t\t\tboundariesElement: 'viewport',\r\n\t\t\t\t\t},\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<Paper>\r\n\t\t\t\t\t<ClickAwayListener onClickAway={() => setDropdownOpen(false)}>\r\n\t\t\t\t\t\t<MenuList>{launchItemList}</MenuList>\r\n\t\t\t\t\t</ClickAwayListener>\r\n\t\t\t\t</Paper>\r\n\t\t\t</Popper>\r\n\t\t</>\r\n\t);\r\n};\r\n\r\nexport default LaunchButton;\r\n"]}